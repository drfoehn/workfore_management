{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Kalender" %} - {{ block.super }}{% endblock %}

{% block extra_css %}
<link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/main.min.css' rel='stylesheet' />
<style>
    .fc-event {
        cursor: pointer;
        border-radius: 3px;
        padding: 2px;
    }
</style>
{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2 class="mb-0">{% trans "Kalender" %}</h2>
    </div>
    <div class="card-body">
        <div id="calendar"></div>
    </div>
</div>

{% include "wfm/modals/working_hours_modal.html" %}
{% include "wfm/modals/vacation_modal.html" %}
{% include "wfm/modals/time_compensation_modal.html" %}

{% endblock %}

{% block extra_js %}
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js'></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log("Initializing calendar...");
    var calendarEl = document.getElementById('calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'timeGridWeek',
        headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay'
        },
        firstDay: 1,
        slotMinTime: '07:00:00',
        slotMaxTime: '20:00:00',
        locale: 'de',
        events: {
            url: '{% url "wfm:api-assistant-calendar-events" %}',
            failure: function(error) {
                console.error('Error loading events:', error);
            }
        },
        eventTimeFormat: {
            hour: '2-digit',
            minute: '2-digit',
            hour12: false
        },
        eventDidMount: function(info) {
            console.log("Event mounted:", info.event);
        }
    });
    calendar.render();
    console.log("Calendar initialized");
});
</script>
{% endblock %} 